<!doctype html> <!-- states the modern HTML5 format for the browser to know how to interpret it -->
<html lang="cs"> <!-- Korenovy HTML tag, language je cestina -->
<head> <!-- hlavicka stranky: Věci, které nejsou přímo vidět, ale jsou důležité pro správné fungování a informují prohlížeč -->
  <meta charset="utf-8" /> <!-- Používej kódování UTF-8, abys správně zobrazoval české znaky. -->
  <meta name="viewport" content="width=device-width,initial-scale=1" />  <!-- "<meta" je TAG a name nebo content jsou ATRIBUTY,
   viewport je misto pro zobrazeni stranky, sirka podle obrazovky zarizeni a scale znamena meritko inicialne na 1 = 100% 
   ani zvetseno ani zmenseno -->
  <title>Google Search Simplified</title> <!-- název stránky, který se zobrazuje v záložce prohlížeče (nahoře) nebo ve výsledcích vyhledávání -->
</head>
<body> <!-- to, co je vidět(text, obrazky, interaktivni prvky, JavaScript, etc.) -->
  <h1>Zobrazení výsledků Google vyhledávání</h1>

  <!-- Vstupní pole, do kterého uživatel napíše klíčové slovo -->  <!-- characters for comments in HTML script -->
  <label for="query">Zadej klíčové slovo:</label> <!-- input TAG je samotne okenko pro user's input, label znaci text upresnujici, co do pole napsat -->
  <input id="query" type="text" placeholder="např. nejlepší káva" /> <!-- LABEL a INPUT se proppji pres "query", tzn kliknutim na text 
  labelu se automaticky oznaci kurzor v poli ke psani INPUTu. "TYPE" Říká, jaký typ vstupu je povolen, Alternativy: password, date (kalendar),
  email (overi format emailu), number. "PLACEHOLDER" - Text, který se zobrazí uvnitř inputu, dokud uživatel nezačne psát-->

  <!-- Tlačítko pro odeslání -->
  <button id="searchBtn">Hledat</button>

  <!-- Zde se vypíše co backend vrati--> 
  <div id="result"></div>

  <button id="downloadBtn">Stáhnout výsledky v JSON formátu</button>

  <script>
    // Jednoduchý JavaScript, který přečte obsah inputu a zobrazí ho pod formulářem. '//' is a way to write comments in JavaScript
    const btn = document.getElementById('searchBtn'); // document = celá HTML stránka, .getElementById(...) = najde prvek podle jeho id="", const = vytvoření proměnné, kterou nejde později přepsat
    const resultDiv = document.getElementById("result"); //const = vytvoření proměnné, kterou nejde později přepsat

    // reakce kliknuti na tlacitko:
    btn.addEventListener("click", async () => { //async znamená, že uvnitř funkce můžeme používat await (čekání na síťové operace – ideální pro volání API)
      const query = document.getElementById('query').value.trim(); // definuje, ktere HTML prvky budou figurovat ve skriptu (pomoci ID prvku), input.value = aktuální obsah pole <input>, .trim() = odstraní mezery na začátku a konci
      // Vyčistit předchozí výsledky
      resultDiv.innerHTML = "";
      
      if (!query) {
        resultDiv.innerHTML = "<p>Zadejte dotaz!</p>"; //pouze vypise chyb. hlasku 
        return; // return zajisti, ze nic dalsiho uz se nespusti
      }

      try {
        const response = await fetch("http://127.0.0.1:5000/api/search", { // odesilani HTTP pozadavku na server, await = počkej, než server odpoví
          method: "POST",
          headers: { "Content-Type": "application/json" }, // headers = říká, že posíláš JSON
          body: JSON.stringify({ query }) // převede objekt query na JSON string
        })

        const data = await response.json();

        if (data.error) {
            resultDiv.innerHTML = `<p>Chyba: ${data.error}</p>`;
            return;
        }

        if (data.length === 0) {
            resultDiv.innerHTML = "<p>Nebyly nalezeny žádné výsledky.</p>";
            return;
        }

        // Zobrazit výsledky
        data.forEach(item => {
            const div = document.createElement("div");
            div.style.marginBottom = "1em";
            div.innerHTML = `<a href="${item.link}" target="_blank"><strong>${item.title}</strong></a>
                             <p>${item.snippet || ""}</p>`;
            resultDiv.appendChild(div);
        });
      } catch (err) {
          resultDiv.innerHTML = `<p>Chyba při komunikaci se serverem: ${err}</p>`;
    }
  });
  </script>
</body>
</html>
